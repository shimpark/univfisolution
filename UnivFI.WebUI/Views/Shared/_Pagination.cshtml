@model UnivFI.WebUI.ViewModels.PaginationViewModel

<nav aria-label="Page navigation" class="mt-6">
    <ul class="flex justify-center items-center space-x-1 pagination-list">
        <!-- 처음 페이지 -->
        <li class="@(Model.CurrentPage <= 1 ? "opacity-50" : "")">
            @if (Model.CurrentPage <= 1)
            {
                <span class="w-8 h-8 bg-gray-100 border rounded text-gray-400 flex items-center justify-center pagination-link disabled"
                      aria-disabled="true" title="처음">
                    <i class="fas fa-angle-double-left text-sm"></i>
                </span>
            }
            else
            {
                @if (string.IsNullOrEmpty(Model.AreaName))
                {
                    <a class="w-8 h-8 bg-white border rounded text-gray-700 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-300 transition-colors flex items-center justify-center pagination-link"
                       asp-controller="@Model.ControllerName" asp-action="@Model.ActionName" asp-route-page="1"
                       asp-all-route-data="@Model.RouteData" title="처음"
                       data-page="1" data-controller="@Model.ControllerName">
                        <i class="fas fa-angle-double-left text-sm"></i>
                    </a>
                }
                else
                {
                    <a class="w-8 h-8 bg-white border rounded text-gray-700 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-300 transition-colors flex items-center justify-center pagination-link"
                       asp-area="@Model.AreaName" asp-controller="@Model.ControllerName" asp-action="@Model.ActionName"
                       asp-route-page="1" asp-all-route-data="@Model.RouteData" title="처음"
                       data-page="1" data-controller="@Model.ControllerName">
                        <i class="fas fa-angle-double-left text-sm"></i>
                    </a>
                }
            }
        </li>

        <!-- 이전 페이지 -->
        <li class="@(Model.CurrentPage <= 1 ? "opacity-50" : "")">
            @if (Model.CurrentPage <= 1)
            {
                <span class="w-8 h-8 bg-gray-100 border rounded text-gray-400 flex items-center justify-center pagination-link disabled"
                      aria-disabled="true" title="이전">
                    <i class="fas fa-angle-left text-sm"></i>
                </span>
            }
            else
            {
                @if (string.IsNullOrEmpty(Model.AreaName))
                {
                    <a class="w-8 h-8 bg-white border rounded text-gray-700 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-300 transition-colors flex items-center justify-center pagination-link"
                       asp-controller="@Model.ControllerName" asp-action="@Model.ActionName" asp-route-page="@(Model.CurrentPage - 1)"
                       asp-all-route-data="@Model.RouteData" title="이전"
                       data-page="@(Model.CurrentPage - 1)" data-controller="@Model.ControllerName">
                        <i class="fas fa-angle-left text-sm"></i>
                    </a>
                }
                else
                {
                    <a class="w-8 h-8 bg-white border rounded text-gray-700 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-300 transition-colors flex items-center justify-center pagination-link"
                       asp-area="@Model.AreaName" asp-controller="@Model.ControllerName" asp-action="@Model.ActionName"
                       asp-route-page="@(Model.CurrentPage - 1)" asp-all-route-data="@Model.RouteData" title="이전"
                       data-page="@(Model.CurrentPage - 1)" data-controller="@Model.ControllerName">
                        <i class="fas fa-angle-left text-sm"></i>
                    </a>
                }
            }
        </li>

        @{
            // 최대 10개의 페이지 버튼을 표시하기 위한 로직
            int totalPagesToShow = 10;
            int startPage = 1;
            int endPage = Model.TotalPages;

            // 총 페이지 수가 표시할 페이지 수보다 많은 경우
            if (Model.TotalPages > totalPagesToShow)
            {
                // 현재 페이지가 중앙에 오도록 계산
                int halfPagesToShow = totalPagesToShow / 2;

                // 시작 페이지 계산
                startPage = Math.Max(1, Model.CurrentPage - halfPagesToShow);

                // 시작 페이지가 너무 앞쪽이면 첫 페이지부터 시작하도록 조정
                if (startPage <= 1)
                {
                    startPage = 1;
                    endPage = Math.Min(totalPagesToShow, Model.TotalPages);
                }
                else
                {
                    // 끝 페이지 계산
                    endPage = Math.Min(startPage + totalPagesToShow - 1, Model.TotalPages);

                    // 끝 페이지가 너무 뒤쪽이면 마지막 페이지까지만 표시하도록 조정
                    if (endPage >= Model.TotalPages)
                    {
                        endPage = Model.TotalPages;
                        startPage = Math.Max(1, endPage - totalPagesToShow + 1);
                    }
                }
            }
        }

        <!-- 페이지 번호 -->
        @for (int i = startPage; i <= endPage; i++)
        {
            @if (i == Model.CurrentPage)
            {
                <li>
                    <span class="w-8 h-8 bg-blue-600 text-white border border-blue-600 rounded flex items-center justify-center pagination-link pagination-link-active">
                        @i
                    </span>
                </li>
            }
            else
            {
                <li>
                    @if (string.IsNullOrEmpty(Model.AreaName))
                    {
                        <a class="w-8 h-8 bg-white border rounded text-gray-700 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-300 transition-colors flex items-center justify-center pagination-link"
                           asp-controller="@Model.ControllerName" asp-action="@Model.ActionName"
                           asp-route-page="@i" asp-all-route-data="@Model.RouteData"
                           data-page="@i" data-controller="@Model.ControllerName">
                            @i
                        </a>
                    }
                    else
                    {
                        <a class="w-8 h-8 bg-white border rounded text-gray-700 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-300 transition-colors flex items-center justify-center pagination-link"
                           asp-area="@Model.AreaName" asp-controller="@Model.ControllerName" asp-action="@Model.ActionName"
                           asp-route-page="@i" asp-all-route-data="@Model.RouteData"
                           data-page="@i" data-controller="@Model.ControllerName">
                            @i
                        </a>
                    }
                </li>
            }
        }

        <!-- 다음 페이지 -->
        <li class="@(Model.CurrentPage >= Model.TotalPages ? "opacity-50" : "")">
            @if (Model.CurrentPage >= Model.TotalPages)
            {
                <span class="w-8 h-8 bg-gray-100 border rounded text-gray-400 flex items-center justify-center pagination-link disabled"
                      aria-disabled="true" title="다음">
                    <i class="fas fa-angle-right text-sm"></i>
                </span>
            }
            else
            {
                @if (string.IsNullOrEmpty(Model.AreaName))
                {
                    <a class="w-8 h-8 bg-white border rounded text-gray-700 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-300 transition-colors flex items-center justify-center pagination-link"
                       asp-controller="@Model.ControllerName" asp-action="@Model.ActionName"
                       asp-route-page="@(Model.CurrentPage + 1)" asp-all-route-data="@Model.RouteData" title="다음"
                       data-page="@(Model.CurrentPage + 1)" data-controller="@Model.ControllerName">
                        <i class="fas fa-angle-right text-sm"></i>
                    </a>
                }
                else
                {
                    <a class="w-8 h-8 bg-white border rounded text-gray-700 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-300 transition-colors flex items-center justify-center pagination-link"
                       asp-area="@Model.AreaName" asp-controller="@Model.ControllerName" asp-action="@Model.ActionName"
                       asp-route-page="@(Model.CurrentPage + 1)" asp-all-route-data="@Model.RouteData" title="다음"
                       data-page="@(Model.CurrentPage + 1)" data-controller="@Model.ControllerName">
                        <i class="fas fa-angle-right text-sm"></i>
                    </a>
                }
            }
        </li>

        <!-- 마지막 페이지 -->
        <li class="@(Model.CurrentPage >= Model.TotalPages ? "opacity-50" : "")">
            @if (Model.CurrentPage >= Model.TotalPages)
            {
                <span class="w-8 h-8 bg-gray-100 border rounded text-gray-400 flex items-center justify-center pagination-link disabled"
                      aria-disabled="true" title="마지막">
                    <i class="fas fa-angle-double-right text-sm"></i>
                </span>
            }
            else
            {
                @if (string.IsNullOrEmpty(Model.AreaName))
                {
                    <a class="w-8 h-8 bg-white border rounded text-gray-700 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-300 transition-colors flex items-center justify-center pagination-link"
                       asp-controller="@Model.ControllerName" asp-action="@Model.ActionName"
                       asp-route-page="@Model.TotalPages" asp-all-route-data="@Model.RouteData" title="마지막"
                       data-page="@Model.TotalPages" data-controller="@Model.ControllerName">
                        <i class="fas fa-angle-double-right text-sm"></i>
                    </a>
                }
                else
                {
                    <a class="w-8 h-8 bg-white border rounded text-gray-700 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-300 transition-colors flex items-center justify-center pagination-link"
                       asp-area="@Model.AreaName" asp-controller="@Model.ControllerName" asp-action="@Model.ActionName"
                       asp-route-page="@Model.TotalPages" asp-all-route-data="@Model.RouteData" title="마지막"
                       data-page="@Model.TotalPages" data-controller="@Model.ControllerName">
                        <i class="fas fa-angle-double-right text-sm"></i>
                    </a>
                }
            }
        </li>
    </ul>
</nav>

<div class="flex flex-col md:flex-row justify-between items-center py-3 px-4 bg-white border border-gray-200 rounded-md my-3">
    <div class="text-sm text-gray-700 mb-2 md:mb-0">
        전체 <span class="font-medium text-blue-600">@Model.TotalItems</span>개 항목 중
        <span class="font-medium text-blue-600">@((Model.CurrentPage - 1) * Model.PageSize + 1)</span>-
        <span class="font-medium text-blue-600">@(Math.Min(Model.CurrentPage * Model.PageSize, Model.TotalItems))</span>
        표시
    </div>
    <div class="flex items-center">
        <span class="mr-2 text-sm font-medium text-gray-700">페이지당 항목:</span>
        <select id="pageSize"
            class="form-select text-sm border border-gray-300 rounded-md py-1.5 pl-3 pr-8 bg-white shadow-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-500">
            @if (Model.PageSize == 5)
            {
                <option value="5" selected>5</option>
            }
            else
            {
                <option value="5">5</option>
            }

            @if (Model.PageSize == 10)
            {
                <option value="10" selected>10</option>
            }
            else
            {
                <option value="10">10</option>
            }

            @if (Model.PageSize == 20)
            {
                <option value="20" selected>20</option>
            }
            else
            {
                <option value="20">20</option>
            }

            @if (Model.PageSize == 50)
            {
                <option value="50" selected>50</option>
            }
            else
            {
                <option value="50">50</option>
            }

            @if (Model.PageSize == 100)
            {
                <option value="100" selected>100</option>
            }
            else
            {
                <option value="100">100</option>
            }
        </select>
    </div>
</div>

<script>
    document.getElementById('pageSize').addEventListener('change', function () {
        const pageSize = this.value;
        const currentUrl = new URL(window.location.href);

        // 현재 URL의 쿼리 파라미터에서 pageSize 업데이트
        currentUrl.searchParams.set('pageSize', pageSize);
        currentUrl.searchParams.set('page', '1'); // 페이지 사이즈가 변경되면 첫 페이지로 이동

        window.location.href = currentUrl.toString();
    });
</script>